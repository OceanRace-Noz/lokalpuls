// Example data - in a real app this would come from an API
export const questionsData = {
  "1": {
    id: "1",
    title: "Wo gibt's Erdbeeren?",
    category: "Freizeit",
    categoryColor: "#1F45CD",
    categoryType: "freizeit",
    question: "Ich suche nach guten Erdbeeren in Melle. Hat jemand Empfehlungen, wo man aktuell frische und schmackhafte Erdbeeren kaufen oder selbst pflücken kann?",
    votes: 34,
    answerCount: 3,
    viewCount: 42,
    userName: "Maria98",
    userImage: "https://cdn.builder.io/api/v1/image/assets/cde1fe42716a4856b5a284e389d2dda0/78ef9f482949556fee014507c039900929e56aec43812f80c22465d974722768?placeholderIfAbsent=true",
    answers: [
      { 
        id: 1,
        author: "Maria Schmidt", 
        content: "Im Hofladen Meier in Buer gibt es aktuell super leckere Erdbeeren! Die haben noch bis Ende der Woche geöffnet.",
        likes: 12,
        date: "Vor 2 Tagen"
      },
      { 
        id: 2,
        author: "Thomas Weber", 
        content: "Auf dem Wochenmarkt am Donnerstag hatte der Stand von Familie Brinkmann noch welche. Unbedingt früh hingehen, die sind schnell weg!",
        likes: 8,
        date: "Vor 3 Tagen" 
      },
      { 
        id: 3,
        author: "Sabine Müller", 
        content: "Bei 'Erdbeeren selbst pflücken' an der Oldendorfer Straße kann man noch super Erdbeeren selbst pflücken. Wir waren gestern dort.",
        likes: 5,
        date: "Vor 5 Tagen"
      }
    ]
  },
  "2": {
    id: "2",
    title: "Neues Hofcafé in Melle",
    category: "Freizeit",
    categoryColor: "#1F45CD",
    categoryType: "freizeit",
    question: "Hat jemand schon das neue Hofcafé in Melle besucht und kann etwas darüber berichten? Ich überlege am Wochenende hinzugehen.",
    votes: 28,
    answerCount: 2,
    viewCount: 36,
    userName: "Julia34",
    userImage: "https://cdn.builder.io/api/v1/image/assets/cde1fe42716a4856b5a284e389d2dda0/a4be9815998d61cd8e7c08f158c34d44e69da7914266ebd03acd8fa6fd6d56ee?placeholderIfAbsent=true",
    answers: [
      { 
        id: 1,
        author: "Julia Klein", 
        content: "Das neue Café hat letzten Samstag eröffnet. Die selbstgemachten Kuchen sind fantastisch!",
        likes: 7,
        date: "Vor 1 Tag" 
      },
      { 
        id: 2,
        author: "Michael Berger", 
        content: "Habe gehört, dass sie auch regionale Produkte verkaufen. Hat jemand schon Erfahrungen damit gemacht?",
        likes: 3,
        date: "Vor 2 Tagen" 
      }
    ]
  },
  "3": {
    id: "3",
    title: "Vorbereitung der Krankenhäuser",
    category: "Politik",
    categoryColor: "#9C27B0",
    categoryType: "politik",
    question: "Wie gut sind die Krankenhäuser in Melle auf einen möglichen Anstieg von Erkrankungen im Herbst vorbereitet? Hat jemand Informationen?",
    votes: 45,
    answerCount: 1,
    viewCount: 67,
    userName: "HealthPro",
    userImage: "https://cdn.builder.io/api/v1/image/assets/cde1fe42716a4856b5a284e389d2dda0/a4be9815998d61cd8e7c08f158c34d44e69da7914266ebd03acd8fa6fd6d56ee?placeholderIfAbsent=true",
    answers: [
      { 
        id: 1,
        author: "Dr. Schmidt", 
        content: "Das Krankenhaus Melle hat zusätzliche Betten bereitgestellt und das Personal wurde aufgestockt. Laut der letzten Pressekonferenz sind wir gut vorbereitet.",
        likes: 15,
        date: "Vor 1 Tag" 
      }
    ]
  },
  "4": {
    id: "4",
    title: "Neuer Supermarkt in Gesmold",
    category: "Wohnen",
    categoryColor: "#FFC107",
    categoryType: "wohnen",
    question: "Ich habe gehört, dass in Gesmold ein neuer Supermarkt eröffnen soll. Weiß jemand, wann die Eröffnung geplant ist und um welche Kette es sich handelt?",
    votes: 22,
    answerCount: 3,
    viewCount: 58,
    userName: "NeugierigBob",
    userImage: "https://cdn.builder.io/api/v1/image/assets/cde1fe42716a4856b5a284e389d2dda0/78ef9f482949556fee014507c039900929e56aec43812f80c22465d974722768?placeholderIfAbsent=true",
    answers: [
      { 
        id: 1,
        author: "Lokaler Insider", 
        content: "Es handelt sich um einen EDEKA, die Eröffnung ist für Mitte November geplant, wenn alles nach Plan läuft.",
        likes: 12,
        date: "Vor 3 Tagen" 
      },
      { 
        id: 2,
        author: "Gemeinderat", 
        content: "Die Bauarbeiten sind fast abgeschlossen, es fehlt nur noch die Inneneinrichtung. Die offizielle Eröffnung wurde für den 15. November angekündigt.",
        likes: 8,
        date: "Vor 2 Tagen" 
      },
      { 
        id: 3,
        author: "MelleNews", 
        content: "Der neue EDEKA wird ca. 1200 qm Verkaufsfläche haben und auch eine eigene Bäckerei beinhalten.",
        likes: 5,
        date: "Gestern" 
      }
    ]
  },
  "5": {
    id: "5",
    title: "Kita-Plätze",
    category: "Politik",
    categoryColor: "#9C27B0",
    categoryType: "politik",
    question: "Wie ist aktuell die Situation mit Kita-Plätzen in Melle? Wir ziehen bald her und brauchen dringend einen Platz für unsere 3-jährige Tochter.",
    votes: 38,
    answerCount: 2,
    viewCount: 75,
    userName: "JungeFamilie",
    userImage: "https://cdn.builder.io/api/v1/image/assets/cde1fe42716a4856b5a284e389d2dda0/a4be9815998d61cd8e7c08f158c34d44e69da7914266ebd03acd8fa6fd6d56ee?placeholderIfAbsent=true",
    answers: [
      { 
        id: 1,
        author: "Kita-Leitung", 
        content: "Die Wartelisten sind aktuell lang, aber für Neuzugezogene gibt es ein Sonderkontingent. Melden Sie sich frühzeitig bei der Stadt und bewerben Sie sich bei mehreren Einrichtungen gleichzeitig.",
        likes: 14,
        date: "Vor 1 Tag" 
      },
      { 
        id: 2,
        author: "ElternratMelle", 
        content: "Es gibt auch einige Tagesmütter mit freien Plätzen. Die Vermittlung läuft über das Jugendamt. Das kann eine gute Alternative sein, während man auf einen Kita-Platz wartet.",
        likes: 9,
        date: "Vor 3 Tagen" 
      }
    ]
  },
  "weekly": {
    id: "weekly",
    title: "Welche Veranstaltungen sollte man in Melle im Herbst auf keinen Fall verpassen?",
    category: "Frage der Woche",
    categoryColor: "#4EACE5",
    categoryType: "freizeit",
    question: "Der Herbst in Melle bietet viele Veranstaltungen. Welche davon sind besonders empfehlenswert und warum?",
    votes: 58,
    answerCount: 32,
    viewCount: 128,
    userName: "MelleConnect",
    userImage: "https://cdn.builder.io/api/v1/image/assets/cde1fe42716a4856b5a284e389d2dda0/78ef9f482949556fee014507c039900929e56aec43812f80c22465d974722768?placeholderIfAbsent=true",
    answers: [
      { 
        id: 1,
        author: "Maria L.", 
        content: "Das Meller Herbstfest ist ein absolutes Muss! Tolle Stimmung, leckeres Essen und viele lokale Händler. Unbedingt hingehen!",
        likes: 12,
        date: "Vor 3 Tagen"
      },
      { 
        id: 2,
        author: "Thomas K.", 
        content: "Die Kürbisausstellung im Gartencenter sollte man auf keinen Fall verpassen. Perfekt für tolle Herbstfotos und die Kinder lieben es.",
        likes: 8,
        date: "Vor 5 Tagen"
      }
    ]
  },
  "user-questions": {}
};

// Simulates fetching a question by ID
export const getQuestionById = (id: string): Promise<any> => {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      const question = questionsData[id as keyof typeof questionsData];
      if (question) {
        resolve(question);
      } else {
        reject(new Error("Question not found"));
      }
    }, 500);
  });
};

// Simulates submitting an answer
export const submitAnswer = (questionId: string, answer: string): Promise<void> => {
  return new Promise((resolve) => {
    console.log(`Submitting answer for question ${questionId}:`, answer);
    // In a real app, this would send the data to the server
    setTimeout(() => {
      resolve();
    }, 300);
  });
};

// Simulates voting on a question
export const voteOnQuestion = (questionId: string, voteType: 'up' | 'down'): Promise<void> => {
  return new Promise((resolve) => {
    console.log(`Voting ${voteType} on question ${questionId}`);
    // In a real app, this would send the vote to the server
    setTimeout(() => {
      resolve();
    }, 200);
  });
};

// New function to submit a question
export const submitQuestion = (
  title: string, 
  question: string, 
  categoryType: string
): Promise<{ id: string }> => {
  return new Promise((resolve) => {
    console.log("Submitting question:", { title, question, categoryType });
    
    // Generate a unique ID for the question
    const id = `user-${Date.now()}-${Math.floor(Math.random() * 1000)}`;
    
    // Map category type to color and name
    let categoryName = "";
    let categoryColor = "";
    
    switch(categoryType) {
      case "freizeit":
        categoryName = "Freizeit";
        categoryColor = "#1F45CD";
        break;
      case "verkehr":
        categoryName = "Verkehr";
        categoryColor = "rgba(10,157,47,1)";
        break;
      case "politik":
        categoryName = "Politik";
        categoryColor = "rgba(209,44,155,1)";
        break;
      case "wohnen":
        categoryName = "Wohnen";
        categoryColor = "rgba(229,146,78,1)";
        break;
    }
    
    // Create the new question object
    const newQuestion = {
      id,
      title,
      category: categoryName,
      categoryColor,
      categoryType,
      question,
      votes: 0,
      answerCount: 0,
      viewCount: 1,
      userName: "Du", // In a real app, this would be the user's name
      userImage: "https://cdn.builder.io/api/v1/image/assets/cde1fe42716a4856b5a284e389d2dda0/78ef9f482949556fee014507c039900929e56aec43812f80c22465d974722768?placeholderIfAbsent=true",
      answers: []
    };
    
    // Add to our "database"
    (questionsData as any)["user-questions"][id] = newQuestion;
    console.log("Question submitted:", newQuestion);
    console.log("All questions:", questionsData);
    
    // Simulate server delay
    setTimeout(() => {
      resolve({ id });
    }, 800);
  });
};

